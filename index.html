<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Telegram Star WebApp</title>
</head>
<body>
  <!-- Telegram ログインウィジェット -->
  <script async src="https://telegram.org/js/telegram-widget.js?7"
          data-telegram-login="dwork777bot"
          data-size="large"
          data-userpic="false"
          data-request-access="write"
          data-auth-url="https://telegram-star-webapp-5vit.vercel.app/auth.html"
          data-lang="ja">
  </script>

  <h1>スターを使って画像をロック解除</h1>
  <img id="lockImage" src="locked.jpg" alt="Locked" width="300" style="display: none;">
  <button id="unlockBtn" onclick="unlockImage()" style="display: none;">スターで解除</button>

  <script>
    // ユーザー情報があるかチェックしてUI切り替え
    const user = JSON.parse(localStorage.getItem("tgUser") || "null");

    if (user) {
      // ログイン済み → 表示
      document.getElementById("lockImage").style.display = "block";
      document.getElementById("unlockBtn").style.display = "inline-block";
    } else {
      // 未ログイン → 非表示
      document.getElementById("lockImage").style.display = "none";
      document.getElementById("unlockBtn").style.display = "none";
    }

    function unlockImage() {
      document.getElementById("lockImage").src = "unlocked.jpg";
    }
  </script>
</body>
</html>
